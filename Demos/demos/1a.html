<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="../css/style.css" />
	<script src="../external-js/Tone.js" type="text/javascript">
	</script>
	<script src="../external-js/audiokeys.js" type="text/javascript">
	</script>
	<script src="../external-js/tonejs-ui.js" type="text/javascript">
	</script>
	<script src="../external-js/NexusUI.js" type="text/javascript">
	</script>
	<script src="https://cdn.jsdelivr.net/npm/webmidi">
	</script>
	<title>Elektron Analog 4</title>
</head>
<body onload="move(); loadJS('/Demos/presets/A4/file1.js');">
	<div class="content">
		

<table style="width:100%">

  
  <tr>
    <td><h5 class="text-align-center">BPM</h5>
					<div class="text-align-center" id="tempo"></div>
					<h5 class="text-align-center">Volume</h5>
					<div class="text-align-center" id="vol"></div>
					<h5 class="text-align-center">Attack</h5>
					<div class="text-align-center" id="attack"></div>
					<h5 class="text-align-center">Release</h5>
					<div class="text-align-center" id="release"></div>
					<h5 class="text-align-center">Chorus</h5>
					<div class="text-align-center" id="cwet"></div>
					<h5 class="text-align-center">Speed</h5>
					<div class="text-align-center" id="cfreq"></div>
					<h5 class="text-align-center">Delay</h5>
					<div class="text-align-center" id="dwet"></div>
					<h5 class="text-align-center">Time</h5>
					<div class="text-align-center" id="dtime"></div>
					<h5 class="text-align-center">Reverb</h5>
					<div class="text-align-center" id="rwet"></div></td>
 
  <td>
	Power
	  <label class="switch">
			<input type="checkbox" checked>
							  <span class="slider round"></span>
							</label>
			
							<div class="grid-patch">
								<div class="grid-item2">
									<div class="dropdown">
										<button class="dropbtn">Patches</button>
										<div class="dropdown-content">
									<h2>Elektron Analog Four</h2>
										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file1.js');">All 8</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file2.js');">Anilgo</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file3.js');">Spider 120</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file4.js');;">Bleep World</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file5.js');">Chirpy Chord</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file6.js');">CBass</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file7.js');">Darkplace</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file8.js');">GritChrd</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file9.js');">luck</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file10.js');">PlsWait</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file11.js');">Pleasing FM</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file12.js');">sines75</a>

										<a onclick="move(); stop(); loadJS('/Demos/presets/A4/file13.js');">Stacker</a>
								<h2>Akai AX-80</h2>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file2.js');">Broken Strings</a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file3.js');">CrackBass - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file4.js');;">Diplodocus - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file5.js');">Easy Pluck - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file6.js');">Gentle - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file7.js');">Grit Lead - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file8.js');">Olsko - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file9.js');">Odd Piano - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file10.js');">Bender - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file11.js');">Ring Dinger - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file12.js');">Simple Rise - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file13.js');">simppleton - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file14.js');">Solids - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file15.js');">Spacy Strings - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file16.js');">SQbass - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file17.js');">SyncBalls - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file18.js');">Cutting - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file19.js');">Wise old pad - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file20.js');">Wobble Sq - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file21.js');">Woderment - </a>
								<a onclick="move(); stop(); loadJS('/Demos/presets/ax80/file22.js');">Working Strings - </a>
								<h2>Arturia Microbrute<h2>
								<a onclick="move(); stop(); loadJS(''/Demos/presets/Microbrute/file1.js');">DynamicSaw - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file2.js');">DynamicSqr - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file3.js');">HareMetal - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file4.js');;">MBStrings - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file5.js');">MicroPiano - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file6.js');">SharpBass - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file7.js');">ShortSens - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Microbrute/file8.js');">ThePubeinyourcoffee - </a>
							
								<h2>Chroma Polaris</h2>
								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file1.js');">Dusty - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file2.js');">Empiricist - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file3.js');">Far off - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file4.js');;">Lander - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file5.js');">Messy - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file6.js');">Poke it with a stick - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file7.js');">Dark Piano - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file8.js');">Ring Sync - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file9.js');">Sharp Mush - </a>

								<a onclick="move(); stop(); loadJS('/Demos/presets/Polaris/file10.js');">Sweet &amp; Full of Grace - </a>
								
								<h2>Alchemy Distilation 1</h2>
								
								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file1.js');">75 Wave - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file2.js');">166000 - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file3.js');">BS Pluck - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file4.js');">DATAFKR - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file5.js');">DiskString - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file6.js');">Early Digital - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file7.js');">FBell - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file8.js');">Fluff - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file9.js');">LASTGRACE - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file10.js');">Lil B - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file11.js');">MStretch - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file12.js');">RM Noise - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file13.js');">R U OK? - </a>

								<a onclick="stop(); loadJS('/Demos/presets/distilation1/file14.js');">ShivBeat - </a>
								
									<h2>Roland Alpha Juno</h2>
									
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file1.js');">BadGuyStrings - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file2.js');">bbass - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file3.js');">Piano - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file4.js');">Biznes - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file5.js');">Bother - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file6.js');">Buttery - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file7.js');">cbass - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file8.js');">cutter - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file9.js');">exs - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file10.js');">Idle - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file11.js');">Multiform - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file12.js');">sbass - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file13.js');">ShapeMod - </a>
									<a onclick="move(); stop(); loadJS('/Demos/presets/aj/file14.js');">Viewpoint - </a>
								
										</div>
									</div>
								</div>
								
								<div class="grid-item2">
									<div id="myProgress">
										<div id="myBar"></div>
									</div>
								</div>
							</div>
							       <p>Use your keyboard, MIDI device (Chrome only) or the sequencer below to play the sounds on this page. Select a different sample by clicking on the Patch button above.</p>
							<script>
							    var i = 0;
							    function move() {
							      if (i == 0) {
							        i = 1;
							        var elem = document.getElementById("myBar");
							        var width = 1;
							        var id = setInterval(frame, 10);
							        function frame() {
							          if (width >= 100) {
							            clearInterval(id);
							            i = 0;
							          } else {
							            width++;
							            elem.style.width = width + "%";
							          }
							        }
							      }
							    }
							</script> 
						</div>
					</div>
					
		
			<div class="number-grid">

			
						<div class="gnum">1</div>
						<div class="gnum">2</div>
						<div class="gnum">3</div>
						<div class="gnum">4</div>
						<div class="gnum">5</div>
						<div class="gnum">6</div>
						<div class="gnum">7</div>
						<div class="gnum">8</div>
						<div class="gnum">9</div>
						<div class="gnum">10</div>
						<div class="gnum">11</div>
						<div class="gnum">12</div>
						<div class="gnum">13</div>
						<div class="gnum">14</div>
						<div class="gnum">15</div>
						<div class="gnum">16</div>
				</div>

	
			<tone-step-sequencer id="seq1"></tone-step-sequencer>
			<tone-play-toggle>Play</tone-play-toggle>
            </td>
  </tr>
  
</table>


						
</div>
					
			
					
						<script type="text/javascript">

						  function loadJS(file) {
						  // DOM: Create the script element
						  var jsElm = document.createElement("script");
						  // set the type attribute
						  jsElm.type = "application/javascript";
						  // make the script element load file
						  jsElm.src = file;
						  // finally insert the element to the body element in order to load the script
						  document.body.appendChild(jsElm);
						  }



						  var midi = {};

						  WebMidi.enable(function (err) {

						      if (err) {
						        console.log("WebMidi could not be enabled.", err);
						        return;
						      } else {
						        console.log("WebMidi enabled!");
						        console.log(WebMidi.inputs);
						           console.log(WebMidi.outputs);
						      }

						      WebMidi.inputs.forEach((o) => {
						        console.log(o.name)

						      o.addListener('noteon', "all", function (e) {
						 
						        console.log(e)

						          let octave = parseInt(e.note.octave);
						          let note = e.note.name + octave;
						        console.log(note)

						          if (!(note in midi)) {
						     
						              console.log(keys)
						              keys.triggerAttack(note, Tone.context.currentTime + 0.01, e.velocity);
						              midi[note] = keys;
						          }
						      });

						          o.addListener('noteoff', "all", function (e) {
						              let octave = parseInt(e.note.octave);
						              let note = e.note.name + octave;
						              let keys = midi[note];

						              if (keys) {
						                  keys.triggerRelease(note, undefined, e.velocity);
						                  delete midi[note];
						              }
						          });
						      });

						  });




						  //////////////////////////

						  var eq = new Tone.Volume({
						      "volume" : -12

						  }).toMaster({
						  })

						  var verb = new Tone.Freeverb({
						  "wet" : 0.0
						  }).connect(eq);    

						  //the feedback delay
						  var feedbackDelay = new Tone.PingPongDelay({
						  "wet" : 0.0
						  }).connect(verb);        

						  var chorus = new Tone.Chorus({
						      "wet" : 0.0
						  }).connect(feedbackDelay);        


						  var filter = new Tone.AutoFilter({
						      "wet" : 0.0
						  }).connect(chorus).start();        


						  //the notes
						  var noteNames = ["B3", "A#3", "A3", "G#3", "G3", "F#3", "F3", "E3","D#3", "D3", "C#3", "C3", "B2", "A#2", "A2", "G#2","G2", "F#2", "F2", "E2","D#2", "D2", "C#2", "C2"  ];






						  var loop = new Tone.Sequence(function(time, col){
						  var column = document.querySelector("#seq1").currentColumn;
						  column.forEach(function(val, i){
						  if (val){

						  //slightly randomized velocities
						  keys.triggerAttackRelease(noteNames[i], "0.25", time);
						  }
						  });

						  Tone.Transport.start("+0.2");
						  //set the columne on the correct draw frame
						  Tone.Draw.schedule(function(){
						  document.querySelector("#seq1").setAttribute("highlight", col);
						  }, time);
						  }, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "16n").start(0);


						  function stop() {
						  Tone.Transport.stop();
						  keys.disconnect();
						  keys.dispose();
						  }



						  Nexus.colors.accent = "#806f14"
						  Nexus.colors.fill = "#ecd7a2"


						  //aENV Controls
						  var attack = new Nexus.Dial('#attack', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.01,
						  'max': 10.00,
						  'step': 0,
						  'value': 0
						  })

						  attack.on('change', function(v) {
						  keys.attack = v;
						  });


						  var release = new Nexus.Dial('#release', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.01,
						  'max': 10.00,
						  'step': 0,
						  'value': 0
						  })

						  release.on('change', function(v) {
						  keys.release = v;
						  });



						  //chorus Controls

						  var cwet = new Nexus.Dial('#cwet', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.0,
						  'max': 0.5,
						  'step': 0,
						  'value': 0
						  })

						  cwet.on('change', function(v) {
						  chorus.wet.value = v;
						  });


						  var cfreq = new Nexus.Dial('#cfreq', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.1,
						  'max': 2.0,
						  'step': 0,
						  'value': 0.60
						  })

						  cfreq.on('change', function(v) {
						  chorus.frequency.value = v;
						  });

						  //delay Controls

						  var dwet = new Nexus.Dial('#dwet', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.0,
						  'max': 0.7,
						  'step': 0,
						  'value': 0
						  })

						  dwet.on('change', function(v) {
						  feedbackDelay.wet.value = v;
						  });

						  var dtime = new Nexus.Dial('#dtime', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.01,
						  'max': 1.0,
						  'step': 0,
						  'value': 0.25
						  })

						  dtime.on('change', function(v) {
						  feedbackDelay.delayTime.value = v;
						  });


						  //Reverb Controls

						  var rwet = new Nexus.Dial('#rwet', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 0.0,
						  'max': 0.7,
						  'step': 0,
						  'value': 0
						  })

						  rwet.on('change', function(v) {
						  verb.wet.value = v;
						  });


						  //Transport/seq Controls

						  var vol = new Nexus.Dial('#vol', {size: [30, 30], min: -36, max: 12,  value: -12});
						  vol.on('change', v => eq.volume.value = v)


						  var tempo = new Nexus.Dial('#tempo', {
						  'mode': 'relative', // "absolute" or "absolute"
						  'size': [30, 30],
						  'min': 60,
						  'max': 240,
						  'step': 0,
						  'value': 120
						  })

						  tempo.on('change', function(v) {
						  Tone.Transport.bpm.value = v;
						  });



						  document.querySelector("tone-play-toggle").bind(Tone.Transport);
						  Tone.Transport.on("stop", () => {
						  setTimeout(() => {
						  document.querySelector("#seq1").setAttribute("highlight", "-1");

						  }, 100);

						  });
						         
						  //keys


						  var keyboard = new AudioKeys(
						      {
						          rootNote: 36
						  
						      }
						  );

						  Tone.context.currentTime + 0.01

						  keyboard.down(function(note) {
						  keys.triggerAttack(Tone.Frequency(note.note, "midi").toNote());
						  });

						  keyboard.up(function(note) {
						  keys.triggerRelease(Tone.Frequency(note.note, "midi").toNote());
						  });

						  // Enable WebMidi.js




						</script>

</body>
</html>